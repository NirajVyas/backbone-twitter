<!DOCTYPE html>
<html>
  <head>
    <title>Twitter Backbone</title>
  </head>
  <body>
    <h1>Twitter using Backbone</h1>

    <form id="new-tweet">
      <label>Author:</label><input id="author-name" name="author-name" type="text" />
      <label>Status:</label><input id="status-update" name="status-update" type="text" />
      <button>Post</button>
    </form>
    <hr/>
    <div id="tweets-container"></div>

    <script src="underscore-min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="backbone-min.js"></script>
    <script type="text/javascript">
      (function($) {
        var Tweet = Backbone.Model.extend({
          defaults: function() {
            return {
              author: '',
              status: ''
            }
          }
        });
        var TweetsList = Backbone.Collection.extend({
          model: Tweet
        });

        var tweets = new TweetsList();

        var TweetView = Backbone.View.extend({
          model: new Tweet(),
          tagName: 'div',
          initialize: function() {
            this.template = _.template($('#tweet-template').html());
          },
          render: function() {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
          }
        });

        var TweetsView = Backbone.View.extend({
          model: tweets,
          el: $('#tweets-container'),
          initialize: function() {
            this.model.on('add', this.render, this);
          },
          render: function() {
            var self = this;
            self.$el.html('');
            _.each(this.model.toArray(), function(tweet, i) {
              self.$el.append((new TweetView({model: tweet})).render().$el)
            });
            return this;
          }
        });

        $(document).ready(function() {
          $('#new-tweet').submit(function(ev) {
              var tweet = new Tweet({author: $('#author-name').val(), status: $('#status-update').val()});
              tweets.add(tweet);
              console.log(tweets.toJSON());

              return false;
          });

          var appView = new TweetsView();

        });

      })(jQuery);



    </script>


    <!--html template-->
    <script type="text/template" id="tweet-template">
      <span class="author"><%= author %>:</span>
      <span class="status-update"><%= status %></span>
    </script>


  </body>
</html>




